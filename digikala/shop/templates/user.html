{% extends "base.html" %}
{% block content %}
{% load static %}
<style>
  /* استایل برای لیست امتیازات */
  .score-list {
    width: 80%;
    margin: 20px auto;
    padding: 0;
    list-style: none;
  }

  .score-item {
    background-color: #f9f9f9;
    border: 1px solid #ddd;
    border-radius: 8px;
    padding: 15px;
    margin-bottom: 15px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  }

  .action-btn {
    display: inline-block;
    padding: 10px 20px;
    background-color: #007bff;
    color: white;
    text-decoration: none;
    border-radius: 5px;
    transition: background-color 0.3s ease;
  }

  .action-btn:hover {
    background-color: #0056b3;
  }
</style>

<div class="score-list">
  {% if comp %} 
  erjkfnkjda
    {% if sh_change %} 
    fgrjie
      {% if final_res %}
        <div class="score-item">
          <a href="{% url 'res' final_res %}" class="action-btn">نتیجه</a>
        </div>
      {% endif %}
    {% endif %}
  {% else %}
    {% if awn|length > 0 %}
      سوالات با جمع امتیاز بالای ده :
      <br /><br />
      {% for a in awn %}
        {% with a as numbs %}
          <a href="{% url 'ux' numbs %}" class="action-btn">سوالات بخش {{ numbs }}</a><br />
        {% endwith %}
      {% endfor %}
      <a href="{% url 'scores' %}" class="action-btn">همه امتیاز ها مشاهده شود</a>
    {% else %}
      <!-- اگر سوالات بالای ده وجود ندارد، ثبت امتیاز -->
    {% endif %}
  {% endif %} 
</div>

{% if res_ind %}
efndkewj
<div class="score-item">
  {% for n in x %} </br>{{ n.summery }}<br> {% endfor %}
  <canvas id="myPieChart" width="1rem" height="2rem"></canvas>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    // داده‌های چارت را از Django به جاوااسکریپت منتقل کنید
    const sortedInd = {{ sorted_ind|safe }}; // فرض بر این است که sorted_ind یک آرایه عددی است.

    // تنظیمات چارت
    const ctx = document.getElementById('myPieChart').getContext('2d');
    const myPieChart = new Chart(ctx, {
      type: 'pie',
      data: {
        labels: sortedInd.map((_, index) => 'مقدار ' + (index + 1)), // لیبل‌ها به صورت خودکار تولید می‌شوند
        datasets: [{
          data: sortedInd, // داده‌های چارت
          backgroundColor: [
            'rgba(255, 99, 132, 0.6)',
            'rgba(54, 162, 235, 0.6)',
            'rgba(255, 206, 86, 0.6)',
            'rgba(75, 192, 192, 0.6)',
            'rgba(153, 102, 255, 0.6)',
            'rgba(255, 159, 64, 0.6)',
            'rgba(255, 99, 13, 0.6)',
            '#000000',
            'rgba(255, 206, 86, 0.6)',
            '#000000',
          ], // رنگ‌های بخش‌های چارت
          borderWidth: 1
        }]
      },
      options: {
        responsive: true,
        plugins: {
          tooltip: {
            callbacks: {
              label: function(context) {
                const index = context.dataIndex; // ایندکس بخش
                const value = context.raw; // مقدار بخش
                return 'ایندکس: ' + index + ', مقدار: ' + value; // نمایش ایندکس و مقدار
              }
            }
          }
        }
      }
    });
  </script>
</div>
{% endif %}
{% endblock %}